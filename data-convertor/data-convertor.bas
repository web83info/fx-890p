100 CLS:CLEAR:DIM M$(3):DEFSEG=0:Y=1:POKE&H1775,5
110 RESTORE:FORL=0TO3:READ M$(L):LOCATE 1-(L>0)*4,L:PRINT M$(L);:NEXT
120 FOR J=0TO0:LOCATE 5,Y:PRINT REVM$(Y);
130 GOSUB*C
140 LOCATE5,Y:PRINT M$(Y);
150 Y=Y+(K=50)*(Y<3)-(K=56)*(Y>1)
160 J=K<>13:NEXT
170 POKE&H1775,7:ON Y GOSUB 180,260,310:GOTO100
180 CLS:PRINT TAB(9)"GPRINT  DATA"
190 GOSUB*IN:IFA$="" THEN RETURN
200 LOCATE7,0:PRINT"DEFCHR$ DATA [";
210 FORL=0TO LEN(B$)/12:DEFCHR$(252)=MID$(B$,L*12+1,12):PRINT CHR$(252);:NEXT
220 PRINT"]"CHR$(13)B$;
230 GOSUB *C:IF K=230 THEN CALC$=B$
240 ON -(K<>32)GOTO180
250 RETURN
260 CLS:PRINT TAB(9)"DEFCHR$ DATA"
270 GOSUB*IN:IF A$="" THEN RETURN
280 LOCATE9,0:PRINT "GPRINT  DATA"
290 GOSUB*C:ON -(K<>32)GOTO 260
300 RETURN
310 CLS:A$="":FORJ=0TO0:LOCATE8,0:PRINTMID$("JPNENG",G*3+1,3)" MODE":LOCATE8,1:PRINT"CODE("MID$(" 33128",G*3+1,3)"-251)"A$;:GOSUB*C:L=LEN(A$)
320 IF K=32THEN RETURN
330 G=G XOR -(K=77)
340 IF(K=8 OR K=29) AND L THEN A$=LEFT$(A$,L-1):PRINT CHR$(29)" ";
350 IF ABS(K-52.5)<=4.5 AND L-3 THEN A$=A$+CHR$(K)
360 IF K=32THENRETURN
370 J=K<>13:NEXT
380 V=VAL(A$):IF V<VAL(MID$(" 33128",G*3+1,3)) OR V>251 GOTO 310
390 FORX=2TO4:FORY=0TO3
400 A$=MID$("04924920",Y*2+1,2):DEFCHR$(252)="00"+A$+"0000"+A$
410 LOCATEX,Y:PRINT CHR$(252);:NEXT:NEXT
420 DEFSEG=&HE000:FORY=0TO7:F=&H9F4+(V+VAL(MID$("-3297",G*3+1,3)))*8:D=PEEK(F+Y)
430 N=32:K$="":FORX=1TO6:IF D AND N THEN MODE50,(X*3+9,Y*3+4)-(X*3+11,Y*3+6)
440 N=N/2:NEXT:NEXT
450 DEFSEG=0:LOCATE8,2:PRINT"Rom Address E"HEX$(F)"h";
460 GOSUB *C:ON -(K<>32)GOTO310
470 RETURN
480 *IN:A$="":FOR J=0TO0:L=LEN(A$):LOCATE0,1:PRINT A$;:GOSUB*C
490 IF (K=8 OR K=29) AND L THEN A$=LEFT$(A$,L-1):PRINT CHR$(29)" ";
500 IF(ABS(K-52.5)<=4.5 OR ABS(K-67.5)<=2.5) AND L-64 THEN A$=A$+CHR$(K)
510 IF K=32 THEN A$="":RETURN
520 J=(K<>13)+(A$=""):NEXT
530 A$=LEFT$(A$+"0",(LEN(A$) MOD 2)+LEN(A$))
540 B$="":FORL=1TO LEN(A$):B$=B$+MID$("084C2A6E195D3B7F",VAL("&H"+MID$(A$,L+(L MOD 2)*2-1,1))+1,1):NEXT:RETURN
550 *C:I$=INKEY$:K=ASC(INPUT$(1)):RETURN
560 DATA"DATA CONVERTOR FOR FX-890P/Z-1"
570 DATA"(1) GPRINT -> DEFCHR$"
580 DATA"(2) DEFCHR$-> GPRINT "
590 DATA"(3) MAGNIFY CHARACTER"
