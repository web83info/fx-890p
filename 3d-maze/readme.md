# 3D-MAZE

無性に3Dの迷路ゲームがやりたくなったので、手元にあったポケコンで開発しました。これで、いつでもどこでも迷路に潜り込めます。

## 動作条件

FX-890Pとその互換機で動作します。動作確認は市販のFX-890Pでしてあります。

## 入力方法

プログラムはマシン語で組まれています。BASICかCALモードで、

```
CLEAR 1024,&HABA,6144
```

と入力して、マシン語エリアを確保します。次にプログラムリスト```3d-maze.bas```を入力します。これはBASICプログラムですから、普通に入力してください。実行すると、マシン語プログラムが書き込まれますが、入力ミスがあると途中でストップしてしまいます。その時は誤りを修正して、再実行してください。

書き込みが終わったら、FDにバイナリでセーブしておくと、次からの読み込みに便利です。

| 項目 | 内容 |
| --- |--- |
| 必要メモリー領域 | 2000H〜2AB9H, 2746（&H0ABA）バイト
| 　プログラム領域 | 2000H〜26EEH, 1775（&H06EF）バイト
| 　ワークエリア領域 | 26EFH〜2AB9H, 971（&H03CB）バイト
| メモリー領域確保コマンド | ```CLEAR 1024,2746,6144```
| マシン語保存コマンド | ```BSAVE "FILENAME",&H2000,1775,&H2000``` |
| マシン語読込コマンド | ```BLOAD "FILENAME",&H2000``` |
| マシン語実行コマンド | ```DEFSEG=0```<br>```CALL &H2000``` |

## 遊びかた

RPGなどでたまに見る3Dワイヤーフレームのゲームです。

```
DEFSEG=0
CALL &H2000
```

で起動すると、タイトルが表示されます。タイトルではゲームのレベルを設定できます。レベルが大きいほど、迷路が広くなります。[4]]、[6]で設定して[RET]で決定します。

ゲームの最初にはマップが表示されます。これは迷路を上から見た図（上が北）です。いったん歩き出すと、マップは途中で参照できません。しっかり暗記して下さい。また。ゴールもここには表示されませんが、目安として、右下の方にあります。

当然迷路は毎回ランダムに制作されますので、飽きるまで遊べます。

スタート地点はマップの左上です。移動はテンキーで行います。[8]]で前進し、[6]で右に90度回転、[4]で左に90度回転、[2]でそのままの向きで、後退します。

ゴール地点には、床に線が引いてあります。ゴールを目指してひたすらさまよって下さい。画面には、今、自分が向いている方向が表示されます（東＝E、西＝W、南＝S、北＝N）。スタートしたときは東を向いています。

## プログラムについて

ちょっとした暇つぶしに最適なゲームだと思います。そんな意味ではポケコンゲームの王道をいっていると思います。このゲームに、他にもいろいろな要素を付け加えたりもしたのですが、純粋に迷路を楽しみたい私としては、今の形に落ち着きました。

迷路を作るアルゴリズムですが、いわゆる穴掘りタイプではなくて、ある部分はあらかじめ壁を埋めておいて、閉じ込めをしないように注意してさらに壁を置いていきます。

3D表示部分ですが、BASICで組むととんでもなく遅いので、マシン語でオリジナルグラフィックサブルーチンを使って高速化しました。アルゴリズムとしては、「画面の両端から、壁があれば横向きの等脚台形、なければ長方形を書き、正面に壁があれば、正面に長方形を書く。」という単純作業を繰り返すだけです。

## 参考文献

* 工学社：「FX-890P/Z-1活用研究」

## 掲載誌

電波新聞社：「マイコンBASICマガジン」1998年2月号 P116-118
