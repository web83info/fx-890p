# Number Breaker

4つのヒントを手掛かりにして、隠された4つの数字とその順番を推理するゲームです。このゲームはルールが単純明快なので、暇潰しにはもってこいです。

## 特徴

この作品は、主要なポケコンである「FX-890P/Z-1/Z-1GR」（以下Z-1）、「PC-E500/E550/E650/1480U/1490U（Ⅱ）/U6000」（以下E500）、「PC-E200/G801/G802/G803/G805/G811/G813/G815」（以下E200）のどれでも、同じBASICリストで同じゲームが動くという「一粒で三度おいしい」ゲームです。

## 入力方法

E500とE200の方は[BASIC]を押してプログラムモードにして、リストを打ち込んでください。Z-1の方は[MENU][2]と押した後[SHIFT]+[数字]として、適当なプログラムエリアを選択してBASICリストを打ち込んでください。

BASICリスト中では、その機種に対応しない命令が使用されている場合があります。しかし、自動的に機種判別をするのでエラーが出ることはありません。

Z-1をお使いの方はやけにスペースが多いことに気がついたかもしれませんが、適当にスペースを詰めて入力したほうがメモリを節約できます。

## 遊び方

プログラムを実行するとタイトルが表示されるので、スペースを押してください。

4桁の数字を入力すると、その数字が答えとどれだけ近いかのヒントを表示してくれます。10回以内に当ててください。

[SAME]は、数字も位置も合っているものの数で、[SWAP]は、数字の位置を適当に並びかえるとSAMEになるものの数です。[LARGE]は答えより大きい数がいくつあるか、[SMALL]は答えより小さい数がいくつあるかを表示します。

例えば、答えが6692のとき、1234と入力すると、

```
(SAME,SWAP,LARGE,SMALL)=(0,1,1,3)
```

6789と入力すると、

```
(SAME,SWAP,LARGE,SMALL)=(1,1,2,1)
```

6666と入力すると、

```
(SAME,SWAP,LARGE,SMALL)=(2,0,1,1)
```

と表示されます。

手抜きのプログラムでは上の例で6666と入力したときに、SWAP=4などと表示するものもありますが、このプログラムではきちんとSWAP=0と表示します。リプレイはスペースキーです。

## 機種による違い

### 機種判別

誰でも考えつくのは「その機種にしかない命令を実行してエラーが出たら、ON ERROR GOTOで処理しよう」というものでしょう。しかしこの方法は、GOTOが無意味に増えてしまう上、プログラムが分かりにくくなるという欠点があります。次に考えるのは、「遊ぶ人にプログラムの最初の変数を一つ書き換えてもらってそれで対応しよう」というものでしょう。しかしこの方法は、プログラマは良くても、遊ぶほうが面倒くさいという欠点があります。そこで、私が採用したのは次の方法です。

__関数の返り値を利用する__

E200でPRINT LEN(STR$(1))を実行すると1が表示されます。E500とZ-1では2が表示されます。E200ではSTR$の引数が正のとき、先頭にスペースが入らないのです。また、E500ではHEX$(1)の返り値は1ですが、Z-1では常に4桁で返されるので、0001が返ってきます（E200系にはG815を除いてHEX$()がありません）。この返り値を判定することで機種判別をしています。

### 機種ごとの違い

今回のプログラムで主に問題になったのは、
	
* 乱数の発生のさせかたが異なる（いずれもN88BASICと異なる）
* STR$()の仕様が異なる（E200が特殊）
* PRINT USING命令の書式の制限が厳しい（E200）
* 変数の使用制限が厳しい（E200ではAとA$が同時に使えないし一文字文字変数は7文字まで、二文字変数は16文字までしか記憶できない）
* 画面の広さが異なる（E200が24桁、E500が40桁、Z-1が32桁）
* BASICとしては標準の命令が使えない。（E200にERASEがなく、G815以外のE200にはなんとELSEがない）
* INPUTの動作が微妙に異なる（?の扱いで表示が微妙にずれる）
* PRINTの動作が微妙に異なる（E200では数字の後にピリオドが表示される）

などがあります。

また、数字を入力するときに何も入力しないで[リターン]だけ押したときの処理も機種によって異なります。
